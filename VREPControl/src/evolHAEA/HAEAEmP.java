package evolHAEA;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.io.Writer;
import java.lang.ProcessBuilder.Redirect;
import java.util.ArrayList;
import java.util.List;

import org.json.simple.JSONObject;

import emst.evolution.haea.ModifiedHaeaStep;
import emst.evolution.json.haea.JSONHaeaStepObjectManager;
import emst.evolution.json.setting.EvolutionryAlgorithmSetting;
import emst.evolution.search.multithread.MultithreadOptimizationGoal;
import emst.evolution.search.population.PopulationDescriptors;
import emst.evolution.search.selection.ModifiedTournament;
import maze.Maze;
import maze.SelectableMaze;
import mixed.MixedGenome;
import simvrep.ShortChallengeSettings;
import simvrep.Simulation;
import simvrep.SimulationSettings;
import unalcol.algorithm.iterative.ForLoopCondition;
import unalcol.descriptors.Descriptors;
import unalcol.descriptors.WriteDescriptors;
import unalcol.evolution.haea.HaeaOperators;
import unalcol.evolution.haea.HaeaStep;
import unalcol.evolution.haea.HaeaStepDescriptors;
import unalcol.evolution.haea.SimpleHaeaOperators;
import unalcol.evolution.haea.SimpleHaeaOperatorsDescriptor;
import unalcol.evolution.haea.WriteHaeaStep;
import unalcol.io.Write;
import unalcol.optimization.OptimizationFunction;
import unalcol.optimization.real.HyperCube;
import unalcol.optimization.real.mutation.IntensityMutation;
import unalcol.optimization.real.mutation.PermutationPick;
import unalcol.optimization.real.mutation.PowerLawMutation;
import unalcol.optimization.real.xover.LinearXOver;
import unalcol.optimization.real.xover.SimpleXOver;
import unalcol.search.Goal;
import unalcol.search.population.IterativePopulationSearch;
import unalcol.search.population.Population;
import unalcol.search.population.PopulationSearch;
import unalcol.search.selection.Selection;
import unalcol.search.selection.Tournament;
import unalcol.search.solution.Solution;
import unalcol.search.space.Space;
import unalcol.search.variation.Variation;
import unalcol.tracer.ConsoleTracer;
import unalcol.tracer.Tracer;
import unalcol.types.real.array.DoubleArray;
import unalcol.types.real.array.DoubleArrayPlainWrite;
import util.ChromoConversion;

public class HAEAEmP {
	
	public static int Nsim;
	public static List<Simulation> simulators;
	
	public static void main(String[] args) throws IOException {
		
		Nsim = 0;

		if (args.length > 0) {
			try {
				// for(int j=0;j<args.length;j++){
				// System.out.println("Argument "+j+" = "+args[j]);
				// }
				if (args.length >= 1) {
					Nsim = Integer.parseInt(args[0]);
				} else {
					System.err.println("Provide a number of simulators");
					System.exit(1);
				}
			} catch (NumberFormatException e) {
				System.err.println("Nsim " + args[0] + " must be an integer.");
				System.exit(1);
			}
		} else {
			System.err.println("Missing arguments");
			System.exit(1);
		}
		
		for (int repli = 0; repli < 2;repli++){
			
			simulators = new ArrayList<Simulation>();
			System.out.println(Nsim);
			// Start Simulators
			for (int j = 0; j < Nsim; j++) {
	
				String vrepcommand = new String("./vrep" + j + ".sh");
	
				// Initialize a v-rep simulator based on the Nsim parameter
				try {
					// ProcessBuilder qq = new ProcessBuilder(vrepcommand,
					// "-h",
					// "scenes/Maze/MRun.ttt"); //Snake
					//ProcessBuilder qq = new ProcessBuilder("xvfb-run","-a",vrepcommand, "-h",  "scenes/Maze/defaultmhs.ttt");
					ProcessBuilder qq = new ProcessBuilder(vrepcommand, "-h", "scenes/Maze/defaultmhs.ttt");
					qq.directory(new File("/home/rodr/V-REP/Vrep" + j + "/"));
					File log = new File("Simout/log");
					qq.redirectErrorStream(true);
					qq.redirectOutput(Redirect.appendTo(log));
					qq.start();
					Thread.sleep(10000);
				} catch (Exception e) {
					System.out.println(e.toString());
					e.printStackTrace();
				}
	
				Simulation sim = new Simulation(j);
				// Retry if there is a simulator crash
				for (int i = 0; i < 5; i++) {
					if (sim.Connect()) {
						simulators.add(sim);
					} else {
						// No connection could be established
						System.out.println("Failed connecting to remote API server");
						System.out.println("Trying again for the " + i + " time in " + j);
						continue;
					}
					break;
				}
	
			}
			
			float[] times = new float[]{1.5f,5.2340f,11.2285f,19.4833f,30};
			float[] envFractions = new float[]{0.05f,0.1744f,0.4574f,0.7575f,1};
			char[][] structures = new char[][]{
				{'s','l','b','r'},
				{'s','l','r','b'},
				{'s','r','l','b'},
				{'s','r','b','l'},
				{'s','b','l','r'},
				{'s','b','r','l'}
			};
			
			SimulationSettings settings = new SimulationSettings(5,"defaultmhs.ttt",180,false,false);
			//ShortChallengeSettings settings = new ShortChallengeSettings(times, envFractions, 0, 5, "defaultmhs.ttt", false,true);
			Maze maze = new Maze(new char[]{'s','l','r','b'},0.4f,0.088f,1);
			//Maze maze = new Maze(new char[]{'l'},0.4f,0.088f,1);
			//SelectableMaze maze = new SelectableMaze(structures, 0, 0.4f, 0.088f);
			
			int realDIM = 234;
			double[] min = DoubleArray.create(realDIM, -10);
			double[] max = DoubleArray.create(realDIM, 10);
			
			double[][] referencePoints = new double[][] { 
				{-2.4526502740759, -1.4104002502822, -2.5306678185546, -0.58357808180598, -2.394712095483, -1.6709319782369, -3.1370519037285, -1.3685149324202, -3.0173907149385, -0.97435585681504, -2.033352819368, -1.4954199531833, 0.58280703129512, -2.8406285588735, 3.3870866594266, -2.3195042122943, -0.31249545924027, -1.1718955488796, -2.0642986048117, -2.7009071122959, -8.444682057846, 0.15439433760652, -9.7845478416465, -0.90972978055234, 1.9857339600173, -1.5925090031626, -8.7257795173865, -5.9630668440754, 1.0660079083058, 0.059915014921899, -5.379308911099, 0.15588391909184, 1.337835612351, 4.0444503190563, -4.2657189165105, 4.9682943278506, 5.4829896927901, -1.221871798317, 0.81747456321588, 0.59596519540455, 4.8129118075178, 4.90751390207, -5.0195007079813, 1.1145320432571, -2.5208909712775, -1.1398644313259, -8.5359879123818, -4.8165440180096, -9.0854898221788, 2.3210249348149, -0.41073933530542, -2.2415009691188, -8.2059755832805, -2.0930434611588, -5.3043960729275, -2.1072370563741, 2.4687135111373, -2.8122276290777, 0.22774207969282, 3.1427280747866, 10.799076170303, 8.6066030708783, -5.7763789801321, -4.6517457288536, -8.1417873889986, -5.3713730364376, 0.3334611251236, -0.96919903089929, -0.64151932166198, -0.28648397114895, -0.65131488875752, -2.457010390845, -1.6322309541258, 0.0013680814064509, -1.2767754702961, -0.17770532000371, -3.0305951313338, 1.8064918274769, -5.0002882910291, -3.4919144749099, -8.0484318307739, -2.7248467393261, 0.45816294932532, 1.0581626557618, 2.1300591864497, 5.294171064194, 9.4311018287229, 4.8793718598183, 0.4506633362896, -4.7017502384791, -7.9972936660582, 0.41521142266164, 3.8205575647736, 3.1590357996632, -1.8179561328323, -4.7654228019637, 2.5151787279468, 0.014002208627233, -6.0236177734023, -12.871966789619, -4.5674912459085, -1.3973977047249, -0.2514912431051, 1.0310462190847, -6.6293216082035, -0.56163566967181, -5.0663901714048, -0.6083541148093, 3.3684763437321, -2.1150635392848, 1.8908261186002, 0.99540948036262, -1.9274764091911, 1.8015027237934, 5.5538162275956, 0.90988220001302, 2.891601465705, -4.6440900606361, 0.15183850825884, -0.22667244860331, -0.1787448341934, -0.083878981260045, 0.2439295692809, 0.42707460340785, -0.94191659078037, -2.6752818492745, -0.013851513225934, -0.60480670373069, 0.68974963984197, -2.8834906989826, -5.0046555791503, -3.9426276153752, -0.68213385690197, 2.4944440880809, -2.4580092272278, -0.17322062226464, -2.7895813108466, 3.3496342572331, -4.8098506021588, -5.9333623079393, 1.7857923452407, -1.7373580629692, -0.49873955498788, -11.139048450288, -8.9668487775705, -2.0172169706682, -6.4270471790774, 2.1712484293454, 1.5006955396723, 0.57380077618768, 1.0573830609897, -1.4327106799487, 7.8807453287085, 12.901618032665, 0.51621331144605, 2.135416038898, -7.2081646201452, 2.7803572374467, 2.0994626819533, -1.5883087661279, 0.43968186555135, -0.98349937652507, -2.280381085095, 0.392389599845, -1.5431657763288, -1.0506293339242, -0.42923827887234, -0.98926712258901, 0.62200021294621, -0.14038489629984, 1.5553308640698, -0.057921059261943, 0.002399213724366, -0.0013129091295887, 0.0062188889749861, 1.0160060643478, -0.0080283250996743, 0.0078713614255718, 0.0057036113846009, -2.6118086636042, -0.012702969896129, -0.0034734346142113, 0.53550144133253, -1.0432074617544, 0.015123761390096, -0.010410617421632, -0.0054713671279343, 0.0063204815733829, -1.8451104370879, -0.012978786842187, 0.012039440468318, -0.0022250432138821, -2.0259184027601, -0.0083875783826776, 0.00027977396062715, -0.52303168237081, 1.7822042396578, 0.020173821140179, 0.0037325056785079, 0.0034163058117714, 0.0016474845202616, -1.9558586872439, -0.0003365928664821, -0.00088044601363153, 0.0051248030086939, -0.93946416458224, -0.0079032775983377, -0.0032392964276999, -0.39637589075223, -1.380909248813, 2.2921971618243, 2.8071620282335, 1.4812489724774, -2.7745101798766, 0.22347373683727, 1.879679498685, -2.2186121079137, 0.80837971897151, 0.43570366350075, 0.28967111663943, -1.8029470407046, -0.18554363157117, -1.208834549995, 4.7615492554633, -2.7017458552029, 0.84794890670524, -2.9922192839973, 0.80373083136065, 2.4045166422315, -1.4218893717017, -2.9564907380905, -0.86294210791006, 4.2890153637065, 2.2502219817212},
				{-2.0505799657083, 1.3721173011039, -4.7057013477879, 1.7404961245329, -3.0266195591931, -0.6957150999119, 0.71750961862156, -9.1467274291106, 2.4730865489386, -6.2013544935054, 0.9060949865445, -2.0862219119452, -0.68046717904587, -0.39058852045782, -0.84652891131744, 2.1704797751951, -6.6951262648574, -0.010513384822523, -2.9165689450121, -0.23484233099873, -6.8842524326783, 3.3442114991916, 3.988829891815, -6.5855374198106, -2.2881676057456, -3.0327615548027, -4.0931429572003, -0.36969386361272, -1.732377167026, 2.661740398759, -0.0018424638276329, 0.051515422970328, -2.753637470096, -1.6594458175286, -5.9683208495098, -6.4627516924551, 5.2161733596052, 1.7969515087617, -3.0366667055921, -0.31469197198644, -3.0347042740677, -4.3868070653112, 1.6227490335454, 1.7498760400428, -2.1270128019153, 0.13923661820602, -2.0511650628105, -2.8328295124215, -2.3907400528816, 0.95296626655875, 0.85165063973004, -1.2199000610835, -3.890508745411, 0.9745957951893, -2.1082296794589, 1.8997130686835, -4.7340805948745, 0.97846917783976, -3.0168335356363, -4.175126522335, 1.9850129637058, -1.7983999081424, 3.287622807826, 1.1500891913394, 1.7229689602474, -0.71059468397697, 4.6437533530441, -0.35295632165202, -0.64643248168074, 1.4636703671461, 0.37404794654825, 0.35465172528305, -6.613964693056, -6.6817053919657, -6.1655132634701, 3.3252912181991, -1.4568445018225, 1.7927044893883, 0.97940987996861, 3.5156748062128, 1.2329998278823, -3.0304862911499, -4.9300385808351, 1.5671382747555, -0.96911957431945, -3.8204121609538, -13.865130712626, -1.7238889028821, -1.2179011677689, -0.45880057015835, -0.94671545089599, -9.0918346477632, -6.6662995024564, -2.0036473676076, -2.5365851684318, 3.2665150285643, -0.37234334118623, 1.5184923258428, 10.78194164847, 0.30017016060715, 3.5248912486787, -7.3820681071896, 1.3686511376213, -2.7042268915763, -8.8556966588982, 0.5858866694845, -3.5990721536055, -0.19996051637771, -5.4846282100538, -3.6486332180272, -1.8188544294161, 2.608524439401, -3.2849810412264, 1.5846074488128, 7.4869198931325, 0.19918671898673, 0.89220527835314, -2.0006042187429, -0.89456149330451, 0.70948174253018, -5.5978288149935, -5.4419888718887, 0.43541913852699, -0.72819038573046, 5.2040923350361, -7.042181233, -1.6292601310033, -0.089931965250359, -0.44323345820589, -0.74991233076139, -10.710161405208, -4.5690173490632, -1.5234646920534, 2.1877844268679, -4.7382316974765, -3.214418156218, -0.063014168437833, 4.5068426397697, 0.80983976056509, -3.0550912578567, 7.3885244477621, -4.2110768063126, 0.28352724293758, -7.0484332731139, -5.0310052777299, -1.4853277408931, -5.2204651587108, 2.594648513041, -0.82080876818072, -1.893247233612, 1.4911404475282, 6.1632125898081, 7.3888695907944, -2.1191737920756, -5.4882073275846, -6.6292319925603, 2.0324671175082, 0.00010855538353466, -6.7353109929567e-06, 0.00011282635261974, -6.7807082331589e-06, -0.00016409660813361, -1.419336820678e-05, 1.5320564807825e-05, -3.0692470651827e-06, 0.00013879128517586, -1.2906442397449e-05, -0.00020055895732467, 9.7486530808621e-07, 0.10988028452438, -6.1764875788342e-07, 3.3114818454722e-08, -5.7825866243369e-07, 3.5607286828855e-08, 8.7916156244342e-07, 7.5280627240804e-08, -8.7965235631904e-08, 1.5752593430897e-08, -7.4642951694144e-07, 6.1282020701738e-08, 9.8773268686937e-07, 7.7879409010305e-11, -2.8063269985228, 0.066021265576456, -0.004780922163868, 0.078568418330926, -0.0057396476226434, -0.10749147205747, -0.0094087693717175, 0.0094776418511473, -0.0022947496132387, 0.088717287123962, -0.0093091076431655, -0.14257717157703, 0.00078318955825843, 2.8101618921774, 0.044588215598014, -0.0031514817424532, 0.052438600601955, -0.0036271051558996, -0.072228029157395, -0.0063518144514374, 0.0064712795115036, -0.0014804430838038, 0.061413440203232, -0.0061849767414371, -0.095500460465536, 0.00050567165135851, -0.39829719042417, 0.67866139013877, 1.1243505878659, -3.2669596098267, -0.20132900386481, 2.4289560982371, 1.6123404685885, -2.0720907499111, 1.881337416231, -3.5624002760582, 0.71843890626605, 7.158262068526, -4.6586246363049, 0.46551882499972, 3.8660295521581, -0.8168426622426, 2.1383894489677, -1.9802130066803, -3.792782677645, 0.45315650010794, -1.639081968937, -0.29361797801399, -3.2706848349088, -1.2368552592997, 0.32791514127999, -1.8843684287115},
				{-3.5797618570727, 3.8151071771127, -1.985535401607, 3.360864792703, -2.9982466844687, 2.5746275122371, -3.1139889479521, -6.8165477729004, 0.71211254707994, -10.305187743953, 2.3302027533734, -1.3857495928225, -0.55931091066862, -9.9184125330937, -2.8326954574517, -2.817507397539, -3.6498123170048, 3.8609817631949, 0.91983318622512, 1.557920856544, 0.44403259859125, 6.8768381623146, 7.4373436360685, -4.7940782131005, -2.529306475971, -7.6719817435035, -1.1661981552602, 5.1686887169784, 4.0772900462571, -1.559329111552, -2.9482413160586, -2.6047015504329, -0.35117832360552, -2.027996649076, -13.362369505603, -1.3900715382342, -3.0946117892731, -2.7351647435692, 2.0130161869335, 1.3101118192518, -0.81304787819585, -5.6317846501749, 0.73412075273214, 0.53417101693289, 0.069888241258215, -2.4773323380902, -2.3574335033987, -2.0421953627098, -1.0894238004879, -15.14928199976, -2.0701495298374, 1.8517749382923, 11.836356779553, 4.9160775757438, 1.1348030280256, 1.5934897931328, 6.8120891244051, 0.51822214666685, 0.57810849510066, -11.14001057118, 5.6770924027565, -4.348332573965, -9.1270714031743, 1.8070183035113, 2.8277255848177, -6.8472741856181, -3.5209378742648, -0.43511316630848, -1.3278127800062, -1.1712346502724, 1.3625431928323, -0.71364611186959, -1.7040286292044, -3.8506426366955, 1.5219799456825, 10.297328596441, -2.246329224163, -2.9291332834002, -1.5088675295928, -4.4140091259655, -1.0399356575757, -1.2356070653574, -5.3963029642586, -1.0658347496204, 2.1861754952558, 0.87252647558196, 0.27890186197209, 0.28348521552191, 1.1187790751822, 0.2639771298986, -0.82588483677101, -6.7727042932928, 0.88030596330394, -0.18472495147035, -5.8440218466535, -4.4780830526868, -2.2073735000838, -3.442073426423, 4.8090108315149, 2.1825410275356, 1.8214681559425, 3.9297828416037, -0.92969988117967, -4.9757563538759, -9.1558038842311, -6.2651612909739, -0.90624957803969, -0.11089495465864, -1.4344650579368, 0.05129102153324, -3.7473813351097, 7.9587630192397, -2.5663016606355, 1.2700989785044, 3.6298091482213, 1.4474232690456, -1.6236595502076, -3.6451565458457, -2.7689343227379, -0.95564116127551, 1.5580982475716, -4.2725488096947, -0.73588042625242, -1.7896903102567, 1.7974909902126, -0.38009041827029, -0.37761730063822, 3.2869639334774, -0.94883604598408, -2.292833737742, -4.6507662414685, 0.80372939404736, -6.2841549198659, 2.2526506982527, -3.9766315284395, -2.0884513321436, 2.0959081717663, -5.2602454319076, -1.865993965739, -3.0312126488641, 7.2230739352034, 2.7841573523967, 4.8195863923666, -4.9127975330596, -3.318197321128, -0.64229265421735, -4.2115907567793, 0.74191259805007, -0.80443836646993, 2.129111123356, 0.81433115287083, 1.8901262610351, 2.9848173284038, 5.9237805829511, -4.8542394357333, -2.5557902332927, 1.5677148128712, 0.059894197916996, 0.12063515912909, -0.0061637292031597, 0.189265965443, 0.030331004742536, -0.050760786408247, 1.1553169705656, -0.05109717801968, 0.028972903981051, -0.24424501399257, 0.03499498541252, 0.043407348414078, 0.11272195452625, -0.0098589228357032, -0.020713940267917, 0.001520081290887, -0.039358130117299, -0.010286163182629, 0.013409927418287, -0.17709402953278, 0.0038337074260196, 0.010006688927389, 0.014285969507494, -0.0035291464504348, -0.012877463117876, -2.6387581928158, -0.0042422864274512, -0.0060245984370671, 0.00011317948351695, -0.0085729802948507, -0.0031206045486673, 0.0011716611660949, -0.07689714952241, 0.0009468477360756, -0.012411946177336, 0.024302511598537, -0.0024566391527134, -0.00048907148774375, 2.6419119378356, 0.061308101186742, 0.11679399580433, -0.010870129150862, 0.17136936409172, -0.038049749428277, -0.023810458713469, 1.7317659565267, -0.13774623676536, 0.15141862778999, -0.61910103549327, 0.084318324286599, 0.00025057102240752, 3.8302779883057, 1.4921044707443, -6.2981987205019, -1.5625717254615, -4.5892608842106, -3.2664814516372, 2.174794436558, -3.5962007110771, -4.7170976630789, 0.66962549675745, -3.4063016250487, -1.134801095154, -3.1440791837523, -4.4395693014355, 4.4031074694944, -4.2769135823365, -0.94639795324887, -2.2489515136176, 4.5209075869859, 1.566047351515, 0.94722453908567, 3.174437636094, 7.8301996159979, 1.7195094781379, -3.5518088103496, -1.1556071669966},
				{-5.3188879171166, -5.0057371715797, -2.1282288612188, -5.5079266036579, 3.3783665509421, -2.0689911288002, 1.8683534958608, 8.4632218232306, -5.3308571995807, -4.8613738083244, -5.4664001275993, 2.1136304747108, 0.22046775108011, -11.08139300693, -8.8565209955446, -2.5442500554643, -6.3645921758855, 3.3080322494753, -0.14630334225682, -3.5088629523033, 1.2731072852436, -2.6758336327954, 7.5200376530167, 14.59353540301, -0.88110653864951, 1.6187199885513, 0.99004654481478, 2.6026964619578, 3.6798243555921, -1.2133313343732, -3.9532765330922, -1.9615844336455, 3.0279961910913, -2.1326041005802, -11.52930581393, -5.3395395184378, 0.28883319186934, -1.37243415398, -0.82982322556376, 2.4536417913761, 2.4313670292527, 5.4598028239778, -5.924528894521, -0.86666639683782, -2.3671431602431, -0.38910847580853, -3.2052953337051, -3.1354818121002, -14.083779944674, 0.12234173498631, 0.83186907880758, -1.7137487353682, -8.6864765656514, -3.935738877535, -6.768096282873, -5.9395713046186, 4.407355932936, 0.27494872773665, -3.2483362756424, 1.8818069978215, -1.9291429848235, 3.8009890476297, 11.421076511449, -2.1483942476197, 1.1601279563175, -5.0580398834067, -1.9874927083722, -4.3991426188191, 3.5393161908495, -2.9530345217911, -0.2607258942233, -0.026629975277335, -0.46138024995284, -2.8158730467451, 6.1697299632734, -7.62974976379, 0.81127702865591, -2.8033186313527, -7.8381685982925, -6.5460244414394, 0.58827510569864, 0.10208191480914, -8.0718935638404, 0.57243708655706, -1.1221072185366, 3.2291645056325, -4.4336284421489, 5.1938003411605, 6.6830284735825, 1.3216352670266, 1.6861117289214, -8.8490667627475, 3.0060886512856, -4.8482542044839, -3.780220943649, 1.0260233373573, -3.570018941586, 1.5310327531275, 0.20908055463955, 3.7023828876247, 9.3272547697758, -4.3862159092377, -1.6953701556542, -2.1781810664453, -8.1396211227009, -6.0237257358887, -2.6619946536978, 2.012741518296, -2.5495392929546, -0.83441069935986, -3.0420686549467, 7.3067455798991, -3.2725667895368, -3.8166558372297, 2.3330864368409, -2.0791829418567, -2.1822872240271, -6.1597043498781, 0.75013651581528, -2.0514859291055, -0.19980910406448, -5.3413727141814, -0.91793531011223, 0.6871243080181, 0.78837346463734, -1.6405266304722, 7.5316222834718, -3.1463589744592, -0.070629717906086, -4.5930717802914, 0.11726878081441, -1.0576198021369, -1.1143163299266, -1.4329719838681, 0.044650465701546, 1.1854215143816, -0.44436937564891, 0.4068613688051, 3.3922832189389, -4.5570619955984, -11.68403534513, -2.4973356136182, 2.5160565004623, -7.9111421835946, -4.2071430942771, -9.9512067136761, -2.2232919846565, 2.5533819159003, 0.3408374583221, 0.95698342955329, 4.4344535240501, 19.593957143044, -5.6023854772284, -2.0169275847491, -5.6011730936878, -3.6848861688338, 8.9050982323325, 2.0827195656036, 2.7975327345526, -1.2743160953024, 2.5800794644257, -1.1274203366913, 1.9941263712817, 6.8740810596035, -0.38325397875622, -1.7907804714087, 1.4429791510791, 0.82928141615183, 2.2032100585467, -0.14903073989814, -1.0127443465032e-11, -5.350097836997e-11, 1.4423552078143e-11, -8.466314065808e-12, 5.5449822112742e-11, 4.0222281695771e-11, 5.4526236816281e-11, 8.0837157328672e-11, -9.1846688557224e-11, -1.2530306256268e-10, 2.9206679843104e-11, -1.3687240913085e-11, 0.51034439113942, -1.7606200644002e-10, -9.3032139273597e-10, 2.5089615460313e-10, -1.4697578982065e-10, 9.6287858556052e-10, 7.0817056914943e-10, 9.4907735570678e-10, 1.4210195717477e-09, -1.5915820937076e-09, -2.2046590395039e-09, 5.0819614835898e-10, -2.3766001867815e-10, -0.51034439123693, -1.2403577084533e-11, -6.5541574341149e-11, 1.7675857562865e-11, -1.0354311823793e-11, 6.7835425114714e-11, 4.9890488284918e-11, 6.6863122609617e-11, 1.0011063306898e-10, -1.1212835677855e-10, -1.5531775383143e-10, 3.5802678647649e-11, -1.6743114727662e-11, 0.13614269697952, 2.2449853168717, 0.2675852707503, -2.8808916274947, 2.269993459032, -1.3595238449282, -2.9225040256827, -0.57857933737603, -5.9110789078205, 2.4929127229296, 7.4848178818718, -5.3706169894882, 2.9508070578867, 0.21693785341388, 1.3384057413105, 5.7027702257974, -2.441332774949, 1.9502213552011, -5.9964736367025, -1.0444205338835, -5.4444877226094, -3.6160385583927, 7.2218604482412, 5.0034571391171, -4.733943038595, 2.9529585943346},
				{-1.6316003154396, 3.0265935872867, -0.039836153566107, 0.25192185181602, 0.92450157172045, -1.2152348048742, -2.258064197352, -2.1854362591678, -11.626742389672, -0.62896865328308, -4.5001529599745, -1.8078390706063, -1.4993957906694, -8.0526710363323, -1.7805704839551, -5.9251825317061, -1.3940225821594, 0.63780744322241, -1.0446370403863, -3.3109460530453, 1.5979955727749, -1.4765549391054, 9.815462841164, -4.0943745830889, -3.7224423183913, -2.68115319841, -6.0125699985508, -1.690204239926, -2.9047286635208, -2.0237173789111, -0.78136545159716, -3.2561727895561, -1.5851437741118, 0.30386815840267, 9.1309337311906, 3.2052081127233, 5.0315482965175, -4.4997618209315, -5.4380469761533, -1.882481919216, -1.481548865354, 0.3823690714626, -1.127479783317, 1.0712230108267, 1.9458534900484, -1.1329212201374, 0.98411867246755, -0.34370398098139, -4.0523736550227, -4.1625628749968, -1.648713989448, -2.9968139466682, -10.449869869232, 0.58801129055092, -3.9852946607931, -6.0573116665473, -6.6287475403019, -0.90597259057241, -2.2124380980574, 10.755671338758, -2.2552486715893, -4.1537636889883, 2.2126607475163, -1.5952309492754, 2.0406523922679, -12.993141010785, -5.1215298483255, -0.4360969707639, -0.2336906505566, -6.3519715617132, 1.8246726414738, 1.5286402220456, 9.3781716539898, -2.5757336715447, 4.9235929680749, 4.6050697056739, -0.03264514681711, -3.2877721828298, -0.31030659050966, 0.32404889144875, 0.27196085412168, -2.4770289033119, 0.89668112473604, 0.22007447131974, -3.0645027111744, -5.6106143970123, 3.7270185599958, -3.287978971464, 0.81534496740426, -2.4401508124856, 1.5178753535883, -4.2100852008617, -3.7294876492342, -0.85035521160933, -4.5899959892995, 1.5783947684022, 0.81011127803766, 1.1910772904038, 7.2376060626419, -2.0489500190369, -1.6020465184632, -5.5369269586683, -2.26487568288, -1.5288239688321, -9.3427094177508, 2.6262015803131, -5.7379335780775, 4.1504317176045, -5.3061616885955, -3.1234466111584, 1.7041655169504, -4.8403067855901, -2.5928205645066, -0.77016119004825, 12.225183541747, 1.7934531172165, 4.7786849554055, -3.6429062079648, -1.9031075421175, 0.57564623038597, -1.7422227422531, -4.1507939557098, 0.43552854755882, -2.7453022542783, -1.2065531141389, -4.0341428689381, -0.16302576802646, 2.1274435418267, 4.097114576823, 4.2347882332794, -10.629573977573, -1.6950167213101, -6.3190835496728, -0.96696042877585, -3.8417548539231, 0.80143251344363, -0.44515265822615, 2.7829932468603, 14.835683680396, 9.2793661224028, 7.0448578312769, 0.88292966408034, 2.0945203425113, -3.9386290001992, 0.92182261665095, -0.30599437736974, 1.2011562855769, -2.2030902936878, 0.036985202810415, 1.7742196695196, -0.18279381096187, -2.7411871570674, -7.7077406966831, 3.9648462587556, 0.10408176570397, 1.6998895927818, -2.9025678240548, 0.037908722645525, 0.082954166286571, -0.019169179842046, 0.52764385528552, -0.010653488738502, 0.0076970314608944, -0.016452184487351, -0.10692041037704, 0.0044081505645113, 0.01396268269874, 0.0093661642714816, 0.033446088601862, -0.29210167646636, 0.12820125487174, 0.26801749847666, 0.0099575651728436, 1.0527437061023, -0.010079751286316, 0.040176623552798, -0.035648284885174, -0.23790242553013, 0.011322227964654, 0.05422763404336, 0.00175778703797, 0.061590479998235, -1.0479657381992, 0.014079496273494, 0.02934189646292, 0.00012643679090022, 0.11973221659524, -0.00098087578010367, 0.0043408073149808, -0.0040010428162358, -0.026922239112012, 0.0012053420500268, 0.0056586372388595, 0.0005826451261877, 0.0072712705377682, 1.0594419266916, -0.070062491736124, -0.14530887741369, -0.00069232882958245, -0.59273324875081, 0.0048504993294373, -0.021208078018724, 0.019852825567249, 0.13336782873653, -0.0059657504177438, -0.028107227132034, -0.0029005700042612, -0.036152291707429, -0.36095215343399, -2.6759976120895, -5.7922740566597, -5.8422765827163, -3.4008421133295, -3.1873535303704, 4.3845590883764, 1.4435804311478, 2.4896472969889, -0.92718802207586, -3.4224212725929, 1.9955295969896, 1.6186551499578, -0.22181996838627, -3.4819084160915, -2.3346771054325, -4.5194906642446, 2.2223773136581, -6.9962319534199, -4.3383001618811, 0.29425803163628, -0.10569488690941, -2.0642337817643, -1.8772822896028, 2.3040315397771, 4.2734356596749},
				{-6.2587183732875, -3.8453015588077, -5.2541286663002, -4.0660563082215, -0.19492063829598, -1.343950535081, -2.0346193452399, 0.29813750629173, 12.627861499552, 11.307707672478, -4.3149798146962, -6.5894254982857, -5.18365416363, -7.9150731285661, -7.2667840674469, 1.0480566163275, -2.9880676266762, -4.2261611120454, 1.3447735412829, 0.97964942649377, -1.5668698081889, 4.5066371489826, 12.896023371124, -1.7009274822511, -4.2630012388164, 0.54524442937142, -0.57365313052775, 2.9215481696233, -0.064230244566724, -5.5189107588599, -2.6547894730661, -2.0351859440762, 0.13000992148033, -3.0607688762417, -0.322721169353, -8.2182423319714, 6.7327619277282, 1.7493654546828, 0.19991666837932, -10.165838227186, -6.6152999737106, 0.22541775706046, -1.636589367728, -6.8610524387681, -3.1095565370794, -3.2626101113434, 0.64237209554727, 0.74754251217599, 13.615087358872, -0.14540308487191, 0.76661525788531, -2.5236790195964, 0.13562931778601, -2.5163835484576, 3.6260149460255, -2.9203662963231, -0.4019317473744, -1.784067633835, -1.9183825806652, -4.2005207617797, 5.01162900108, -6.3354313143159, -5.3412920860708, 2.0598223823478, 1.9204591996392, -10.070871603912, -4.977983871308, -1.7189718894778, 1.7362539790284, -1.526400167533, -2.3400732238082, -1.2187312372266, 4.6185014809514, -3.7551169278498, -0.67988800627647, 6.4763460758113, -2.2461826399503, -2.2906834351434, -8.6163887649775, -1.5592395666257, -7.131052462666, -0.62580608623165, 1.6472723690463, -2.0755452370085, 0.44985875153909, 2.0733386559553, 14.660403943693, 10.30948768898, -3.0409135643615, -4.2518411084718, -2.3345880854584, 3.3506321833727, -1.8959260891229, -1.8317713004607, 1.574222859222, 2.4586232111986, -1.5982787194543, -2.9169825543529, -3.4765275025522, -10.682126594649, -6.2263409172246, -16.504328597684, 1.0793485053963, 0.24459893155463, -0.089212945508193, -1.8896540488036, 1.6858293495439, -1.8602506139813, -0.067379692652146, -1.4427726762214, -0.22141723426381, -5.2155846186091, 2.8354147062298, 0.54332470897749, -5.3021204221133, 0.044581795595533, 1.0410545249656, -4.4521774655669, -4.7611416886163, 2.4395378848033, -4.5776362527417, 1.5645515016839, -2.3505159102986, -3.2114920931543, 7.1390346342919, -0.50738463583964, -1.6077531479126, -5.6988899584316, -2.9969336639316, 0.77565007217525, -9.8776999939204, 0.83489831151241, -3.5876217655917, -0.64460443026899, -6.5909725636334, 0.44043682735447, -3.5882780213278, 1.6454565642361, 0.19852991890293, 0.042846432844762, 9.1515685691455, 3.4961097640798, 1.1753465132669, 2.8365669159065, -4.5578070704554, -5.0062257497641, 3.5621470242649, 4.5477393461468, 0.2845361476935, 0.69130328969878, -3.1663350771919, -16.457055180088, -7.348740182196, -9.6676142805478, -2.5844158466076, -1.466856104425, -6.8538137186995, 0.43315696823871, -0.94717328228138, -0.61337058975501, -1.1478587602286, -0.12761739221467, -2.1955784192488, -0.34105243244555, -0.12393492170726, -0.050473771550711, -1.6826760304232, 0.099375948441542, -0.8260880128994, -0.094287750569649, -1.6429892366826e-10, 3.7860016483836e-10, 5.7390882518236e-11, -5.8410849534508e-10, 4.1085719787837e-11, 2.7741012369587e-09, 1.4757916785723e-10, -1.0349583716602e-10, -1.3293542113868e-11, 4.1880636652926e-11, -1.7015111381533e-10, 1.6004108657163e-10, -2.6196427591692, -8.2796328041119e-05, 0.00062820047107972, 2.1830137683327e-05, -0.0010323383021651, 0.0001219470414898, 0.00074068217575623, 6.4633834295985e-05, -0.00014882039544208, -0.00015900709289941, -2.2477079735611e-05, -4.3088539525766e-05, 0.00015168762049552, 2.619552784704, -0.00027681000297985, 0.0020506948528187, 7.3427238319458e-05, -0.0033676564462396, 0.00039640437319995, 0.0025418984998589, 0.0002164978971494, -0.00047497533408116, -0.00051528746078454, -7.035016603512e-05, -0.00014834992032534, 0.00049043702374959, -0.79969959341285, -3.559912273321, -2.2095830939743, 0.96018454165682, 4.4395318376765, -0.96615190729285, 5.9365379153794, 2.0272967571921, -6.005896884431, 2.6076153149105, 1.4640181606774, -2.0273759935446, 4.3512255784569, -0.43877827362263, -3.2366519448039, 3.6513852060064, 0.39649803596155, -4.9925224865816, 1.8236021358581, 3.6243532296469, 2.2299282008509, -2.5085025341677, -1.8648305693305, -0.30439364919965, -2.6587647385434, 2.3237592493158},
				{-7.8752890544846, -2.1153453971562, 0.86091496998602, 0.98593440390098, -2.6937963954221, -0.4230716624194, -0.13785583478298, -1.0481843004661, -3.3624965249522, -1.7928859743459, 9.0342680061164, -2.5398083349388, -0.44546499863979, -2.325005952028, -1.0687432646813, 4.1139854584337, -1.6630115979245, -3.098400199639, -1.6650261897352, 1.0800071982909, -3.3981186402506, -9.6419154835163, -3.2090055952496, -0.43438968975439, -2.3631259930348, 1.2113772974323, -11.155210671293, 1.1972260759318, -4.8260370962134, -4.2086325391169, -5.628804022253, -0.24330736531859, -3.7608197910989, 10.679250633937, 3.0403539007208, -4.0187837575093, 1.007436530514, 0.99546083689518, 4.7916403009821, -6.7482597166948, -3.7214352214301, 3.2941838995453, -3.044618965258, -2.1105591699736, -1.7160456760814, 1.0625694549615, -1.5115095388273, 6.8776533755464, 2.2647623236044, -0.12446008910988, -0.5551650214331, -0.1780536703156, 0.80078798489331, 2.1191248454945, -0.87653930680719, -0.13415919493138, -0.77967934670884, -0.48321752729483, -1.209298199179, -8.4172883627965, 2.7717939286728, -7.6980395439602, 0.88618527548093, -2.6708274627811, -0.94498415056242, -3.0298619969061, 3.9190304028702, -4.8105840364935, 2.6141656157456, -2.2979757900906, 2.1607021467737, 2.3703120538941, -8.1320067795759, -6.1740910722636, -5.5461672906545, 5.7440479690179, -1.0865729893904, -2.831372528837, -9.4057326573717, -6.6627039561337, 0.34212704233609, -5.7618482454945, 3.8845929756597, -3.3682583482549, 0.22156204324378, 0.75545580006044, -4.0880079254813, 8.0693311680304, 10.373537055421, -0.88885620692747, -5.6141405384056, 1.4052130655296, 5.506855929495, -2.9364536936572, 2.717620486004, 1.6505542807321, -0.60123871238063, 0.20608921098434, -6.7987005845838, 0.05861350721472, -4.6533131549062, -16.784951760083, -0.11625566624551, 2.9150271051331, -10.214226900169, 1.7060014321798, -2.0858976041112, -8.0694187973267, -3.9366831483346, -3.2483812567347, -3.0888911268243, 6.49339874541, 8.4120972656102, 2.5691360489759, 1.5809107221912, -1.5609706551313, -1.5659487735957, -6.1647568182738, -2.7694600618173, -5.8601672621027, -6.5218967959152, -1.1906793965695, 1.5107905737524, 1.3032859660154, 0.19854350934324, 8.8895102356565, 8.5955137464675, -3.1270056021955, -4.6144063283189, -5.4898836758418, -5.1889679445911, -4.6947809074432, -0.23206656828182, -2.4168521879192, 2.4760442230353, -2.8387331459207, -0.81887239306259, 0.79134971066687, -4.7325968213427, 4.4094012688986, 7.3545084131537, 0.044273045656451, -2.637090324613, -12.804628348324, -4.3262603554909, 0.7580574328575, -1.7354322337315, -4.7171766605409, -1.5940323252576, -1.4182959100576, 0.37183977902876, -3.1270837843012, 14.244639800583, -0.62398956220542, -2.4895768982165, -2.353298082649, 1.7795835850577, 1.4610655368917e-06, -1.9083145411281e-06, -1.1132308504505e-06, -5.2564649579807e-07, 3.0410839883016e-07, -6.4412874021315e-07, 1.1959616523935e-06, -3.7771090531323e-07, 7.3765445568707e-07, -1.037373385038e-06, -1.1760452318112e-06, -8.50711094029e-06, 0.13152463859155, 4.0553280896992e-11, -5.5540329394896e-11, -2.4181081975673e-11, -1.0920914102254e-11, 7.3624435371371e-12, -1.8346021056783e-11, 3.7658637972435e-11, -1.1198414676407e-11, 1.4085387036903e-11, -2.5633040639409e-11, -3.5634017095749e-11, -3.6313142522572e-10, -2.8202584249061, 0.002043023450664, -0.0024581217214306, -0.0017636177944106, -0.00084625524399058, 0.00044903408809405, -0.00087608278299521, 0.0016060525327295, -0.00050090668657793, 0.0012387854000042, -0.0015860063463773, -0.0016141941061194, -0.0081501320048621, 2.8206154061542, 0.00077021218961842, -0.00089726358467552, -0.00076054251866428, -0.00035660114805875, 0.00017977972963685, -0.00033616791498311, 0.00061451326948213, -0.00019220309774417, 0.000547584314862, -0.00065028734637411, -0.00062104488180627, -0.0027191641939744, 0.018465224562741, 1.3840932139195, -4.3226521814607, -3.0850504189078, -1.7853130623919, 2.4358622916255, -2.5056653581173, -1.8331008032502, -1.4436263461535, 2.2052731005121, -4.9786326704102, 0.90377511556998, 4.4237355334283, 0.37241805584297, 3.9278873525925, -2.8396042559716, -5.9788148405382, -2.5465838692708, 1.9562718200106, -2.6714389755037, 3.9954584959958, -1.4186869565024, 4.7825300903988, -4.9594654961904, -4.1321128857251, -3.5785789613562},
				{-3.5064305948898, -1.6366827384985, 3.6200467321637, 0.97957848100182, -3.3050090832447, 0.90610227522565, 0.78218167622699, -5.0529974623096, -7.8722034520497, -2.594253618864, 4.6474184265801, -0.86889229472702, -0.20273261647645, -9.4013916710061, -6.7564257910651, -0.78552973015287, -6.4015077894453, 2.7480845588366, 1.1585171691175, 1.1511585789766, 2.7236629461731, -1.5140423651835, 6.4510576316267, 10.734702821946, 1.4644538150188, -1.9538179668579, -5.3531995253487, -4.8418582346333, 1.7211923331746, -2.438737274416, -1.7335552043146, -2.6678563174404, -2.0719405137546, -4.6655078006988, -2.8221950714775, -0.74209533337888, 9.0877835946911, -2.1128811902346, -2.484403686689, 8.7843300380023, 2.6232548874051, 0.89877698439783, 4.9691596251904, -3.3506985785143, 1.3278141505665, 2.5247834091654, -0.54438341732319, -7.9241941696588, -7.9992843661746, 5.917703249231, 7.7341172454854, 2.9450232230103, -9.4654283500658, -3.8490750670951, -2.4792060744091, -3.8171617620316, 1.2280082433311, -3.104128251275, -2.0679175476116, 13.219122138198, -3.6506970773869, 1.1124975396431, 2.1253321508087, 1.8817367040837, 1.9163310899684, -6.9070930841417, -1.2037482323224, -2.665288989957, -3.3675257209696, -1.231128291106, -1.8962356379912, 2.3092964136318, 7.2317528227318, 0.986421477701, 2.0297225666895, 3.4460376730509, -3.506931293295, -1.0261906865102, -1.36625940038, 0.6742977312719, -0.90972326884975, -0.79176861266632, -5.0487119889445, 1.975844926795, 0.9108838258664, -3.5568082403719, -10.546340304096, 1.1764454282985, -0.34987388743339, -1.1461207925081, 2.7652407341897, -0.61657405741352, 0.19874954248358, -0.32225962031823, -0.26022970326211, 0.076528939279117, 2.8033752559649, 2.9032343166845, 0.54505110463194, -4.2131538610166, -1.0546050740152, -11.732527119561, -0.88170395046079, 1.0208956534083, -9.8922722783551, 0.53251923099829, -5.5098714189055, -7.4587517750938, -6.4833555993734, -0.74426802989705, -3.081950646794, 9.0327570748979, 2.1326169646125, -3.0292884833314, 3.8272006977073, 0.44465002947506, -0.81551936856453, -3.3223459616661, -4.2703626767922, 2.5798403954652, -2.8934016982257, 1.9154192938249, -2.8830411540194, 2.4564796421828, -4.6805611048882, 1.0145889435553, 1.9164440556866, 8.6134423394212, -4.4174034353347, -4.5200706068428, -1.891404672345, 0.66034682107293, -1.9822829848272, 1.1421768247125, -4.710058730639, 2.9163898931067, 2.971668974794, -3.7646464936246, -5.8497937624481, -1.6340610781132, 0.89167108671561, -1.1050649689982, -1.3935697939718, -3.3824674386988, -5.8291390776951, -2.8508867831254, -2.2188988790167, -0.43511698702998, 1.8218736546814, -2.2053231139899, 7.1865465974878, -3.5569367522199, -3.0333680747243, -4.7462807910842, -3.3384007395092, 1.212433167469, -1.1519326430016, 9.9766215306759e-07, 5.1590262195963e-07, -9.8858188056293e-07, 1.6739976565526e-07, -9.72532262598e-07, 1.3043689727865e-06, 1.1799925465706e-08, -4.9916339558597e-07, -1.6181496011779e-06, -3.7612675451677e-07, -3.6158668706655e-07, 1.8289550920742e-06, 0.26524466108902, -2.8895231121272e-08, -7.2460941742541e-09, 2.3466675863978e-08, -4.4851036053526e-09, 8.9330619685777e-09, -6.9278527282748e-09, -6.3184548172287e-08, 1.4979790898276e-08, 7.4873982023226e-09, 7.4232786514001e-09, 8.5569891867159e-08, -1.8043062283277e-08, -1.6959253383548, 4.2620265152632e-05, 2.1461843036998e-05, -4.2160290455933e-05, 5.9809171200896e-06, -3.8403371898455e-05, 4.8773695746056e-05, 1.1350392909675e-05, -2.1599326307181e-05, -5.6945555492051e-05, -1.5504471456394e-05, -2.6474499437489e-05, 7.4827588788781e-05, 1.6959223732238, 1.8485274048793e-05, 1.0091052900751e-05, -1.9745873756323e-05, -8.1840843074463e-07, -1.4739405518942e-05, 1.2730415764795e-05, -2.2336473653018e-06, -6.245958602049e-06, -3.2628360511591e-06, -6.1603220124291e-06, -2.1842120279794e-07, 3.1882965005748e-05, -3.5064086349429, -5.2474759814885, -3.1882026434064, 5.1372690035892, 3.4724604213515, 3.3350116410498, -2.2733396959963, -4.0267871359593, -2.5630113830305, -2.0010420719533, 1.651099974009, 0.29434528809616, -1.8498578573869, -2.6400886115727, 2.2232258940608, 1.4602171828001, -0.67213067860979, 3.0672543791874, -2.9435940268723, 3.7829501851709, -3.0887512071892, -3.9280316686668, -6.4726857761262, -1.7862189575809, -3.9065023251024, 5.4685950511141},
				{-8.933473226934, 1.1586520731938, -0.11183297886937, -5.1813464226339, -1.7019283430042, 1.1962219277078, -1.3404859038389, 8.5639299493199, -1.3864792201506, -1.9876952472255, 1.2507303300664, 0.96863093002978, 0.054620411799301, -13.690410609337, -11.049865551983, -0.84024711205523, -11.720025212385, 4.1594863760736, -1.8167841457741, -3.6527300034629, 0.61676644116656, 0.11728723659136, 9.3591405542069, 17.540976432339, 3.3959143737804, -1.5351797166739, -4.3640872251624, -2.4730045840207, -1.2868111010287, 1.2738098600267, -2.5140508367258, 1.65546226136, -1.2207508477607, -3.4290073569432, 2.0676143680473, 3.7710553757299, -4.2815946691859, -1.8858738786868, -0.33481174366089, -6.6555871647092, -7.1962175077628, -2.060921462886, -7.4760199715269, 2.2991938539062, -3.1477353109071, -3.0506654988998, 0.80274389163694, 3.771890653548, 4.9152030449881, 9.6041879561869, 2.1909029840792, 1.1341666871051, -0.28394306902136, 1.780098907682, -1.0711423789166, 0.1793974087418, 2.3039489904156, 1.1146046614421, -2.9995041254763, -1.4011491487099, -3.7389151406093, -2.5175594684106, -14.691082074016, -0.88827185962437, -0.19688347984191, -3.512933393056, -2.6372999915296, 2.4709547448892, 1.3699174039797, -2.1785562099868, -1.5388648365671, -1.2585689681629, 2.178771892678, -2.9178692139593, 1.0308464239204, 0.040301841299134, -0.20689553547492, -1.8458758356406, -3.03483945823, -3.4673249457779, 3.9699478442687, -5.0447402210588, -1.2583261785621, -2.0552628009978, -0.076208038947278, -8.6893881303117, 5.2128527447446, 3.4065767002368, -3.7519749360149, -3.4171882095277, -2.9139363794118, -5.2477137979209, -1.092106178546, 0.33614382028642, -5.0005737054905, 4.7868619292618, 1.5035973090484, 2.3851716305867, -5.0162094713689, -4.0780410194798, -0.39217559431118, 6.3084067493701, -0.21895899409787, 0.34182663010075, -9.3828690812031, -5.1028297042568, 0.84053113003372, -0.46836954134481, -6.1628235012076, 0.24382291840351, 0.60685704754623, 4.9591081854238, -0.77643198956307, 5.4783058350295, 5.0735189984333, 3.2746553340166, 2.6485770533963, -1.2173863694687, 5.7343447184679, -2.9399869240469, 2.0971382455018, -4.3557788992625, -2.9471266518223, -2.2098326866391, -10.984752213848, 3.7233588109041, -8.1565510957234, -5.8505450485621, 0.097440234313883, 0.59419914607256, -0.62978975432946, 2.6489839140445, -0.18298615566338, 1.5821343311308, -2.2508532939906, 2.0920303159812, 2.4769145803013, -4.796088722029, 1.1574074738351, 0.0087054071654344, -0.36528533207983, -1.9942157248602, 0.96025504836732, -6.1794908888385, -2.8434727174787, 0.4325020576149, -4.5306730770005, 1.7519921104718, -1.4372797752146, -0.56017058849081, 9.8922390490008, -4.7713533036762, -3.7645524532591, 1.1870439405561, -1.4192414623653, -2.8725518588874, -1.2989694465625, -0.00041184978554609, 0.0011175193780604, 0.048706993403856, -0.0020315031379483, 0.00046673850775166, -0.0028974571207272, -0.00016000929545539, 0.00094580010134175, 0.0010387359102284, 0.00073753902368367, -0.0017733527822039, 0.00052201732174958, 0.18701155200453, 7.4453881281495e-05, -0.00010837187984896, -0.0049178768970801, 0.00020768687756846, -4.6800102451177e-05, 0.00031517954880851, 3.1508947414786e-05, -0.00010216111635218, -0.00011019685948812, -7.3096914860993e-05, 0.00018710816103141, -5.9157166321279e-05, -2.5997997625851, 0.00047122155528198, 0.010278405839406, 0.49753446778033, -0.017819173583467, 0.0068093293869654, -0.024387528045324, 0.00058217908926505, 0.0081951687713138, 0.0092140029902089, 0.0073344653933568, -0.01665830655781, 0.0040571878242684, 2.6017896162413, 0.0064899113597713, 0.004781621133455, 0.4964344174974, -0.0094474356152911, 0.011559066478238, -0.01838490437004, 0.00022110120339356, 0.0064614460736641, 0.00619060090985, 0.0062167780330855, -0.014577324018822, 0.0021979118719106, 0.14151705155039, -3.1177643532142, 1.4894698850645, -0.082778807561599, -5.1169288683952, -3.3454100042354, -2.4662182015777, 1.0075835068609, 3.0007363193542, 3.4431851604489, 1.2529863486801, -0.66825841315344, 2.0240642747825, 0.9163022540898, -3.3842738818699, 5.7892069957015, 4.3121761543526, -6.5749760118588, -4.0823995157436, -2.7284136048003, -0.49352423189217, 0.091436347424696, 0.58332876063034, 1.6507850126473, -1.7524394187342, 0.22201430908435},
				{-6.1436851480317, -3.7015712986751, -7.4463527362063, -2.1575154230541, 4.8860849367175, -0.82597363953753, -0.31173060582292, -0.16471320140252, -1.2406404818445, 6.1760976535544, 5.130653536966, -3.6430726668641, -1.3021127509728, 0.26537620341785, 0.89517655317328, -0.26138172643455, -2.9463541366565, -1.2024781000017, -2.1423968950562, -1.6110556813233, -0.23378011001748, -11.095772730905, -1.0148146840043, -7.2233083748668, -0.64587430328693, 1.8197147925514, -6.4720011626317, 1.9803178254331, -4.9749075780376, -2.6455984586123, -3.7233131763876, 0.18700152139236, 0.2675509403186, -2.7007991474442, -0.74119089521, 2.4492136340083, 4.8522534240531, 4.4400085846792, 0.41043807499924, -5.2496087398164, -3.4534534382648, -8.9662768567226, -3.837542210631, 6.2075033118534, -3.6918213108161, -0.85516818348099, -7.0200422314648, -5.3522894785453, 6.3019916681571, 10.089859009157, -3.5123523204029, 0.12626416977498, -2.8033005048975, -4.4055893882026, 0.69147076190443, 0.087425357307491, -4.3288830679692, 0.36779688593479, -2.6448102424246, 2.2224832979538, -0.24031724262106, -6.2639419305313, 2.2257592536026, 1.3338963083708, -2.7522933900571, -4.555338218522, -0.4058307540071, -1.0458611625044, 3.4965669566613, -2.8946418420356, 0.37281140352666, -2.3695223187742, -2.6189172855252, -1.4315739663083, -1.4034457783828, 1.9935430359667, 2.1715804925815, 2.1578148734451, -4.382282862218, -0.75971880347367, -2.0605100312399, -2.3317697616331, -1.9982077900577, -1.5011756930278, -0.47172326480613, -3.3441439707308, -0.77841249686893, 0.092372646595907, 0.60218529846003, 1.3529029581034, 1.5047986115598, -7.6836335355978, -0.83458304126321, -2.1851880899354, -3.478083671952, 2.2403728930925, 1.8518254261966, 1.5402688587587, 6.6090524525072, -2.1376867945118, 4.343313302104, -1.7414250991541, -0.84103375200322, 3.1862010649205, -3.2748827726911, 4.2158378784457, -4.2769552143387, 1.8480064394004, -4.4536887027027, -1.8098807899035, -1.4261316029108, -5.3220221100889, 6.2118141840983, -8.9341803610278, -0.75575869466201, 1.7646933142114, -0.073558379894153, -7.5298598443698, -0.78073053810476, -4.4716706520572, -5.8300547206327, 0.74903949251974, -2.5044622786118, 1.6604043886291, 1.19956037896, 7.7601997344009, 8.9031103026535, -6.858496829104, -1.9856589424971, -3.3138131161767, -8.0325943516598, -1.0792656118284, 1.7829199831903, -2.9124395424832, -6.1321330823568, 0.083734804894461, -3.3971413139815, 6.628793654118, -4.6208816789321, 2.4854101524517, 5.6439559183926, 1.1682183607188, -3.1949785496401, -10.211749591028, 0.46449651995229, 1.0748000305776, -8.6274189574263, -5.0941674072347, -0.35263571721515, -3.5506979489793, 8.003588689751, 1.2496836020822, 7.52777328808, 8.1065387940471, -4.5990427326513, -2.8548402836648, -1.4855538933912, 6.3556565667806e-05, -0.004479815299201, -0.0036096061238796, -0.00062194015458409, 0.0024404318135694, -0.00037135550431192, 0.73854629964065, 0.0010206776808523, -0.00071251648140108, -0.0005024162925703, -0.0011185577689592, 0.0005492435559499, 0.078246246135452, 3.0546336121846e-05, -0.0047225372445942, -0.0037432041759117, -0.0006565473716937, 0.0025971815362444, -0.00040743669207714, 0.76221751827548, 0.001000958810384, -0.00076246907396306, -0.00050634456660593, -0.0012635657777063, 0.00063480794510701, -2.6562932396352, -7.974684581293e-05, 0.0038655460055825, 0.0030013497266516, 0.00052002217078775, -0.0019337696006228, 0.00036399985268989, -0.62160236796341, -0.00089832785263331, 0.00058053067084823, 0.00043352239780316, 0.00083459770121226, -0.00039606309347897, 2.656886638267, -4.775863880949e-05, 0.0022935547813662, 0.0017068812990881, 0.00030841426834783, -0.00098628893097996, 0.0002027797351779, -0.36356910356909, -0.00052916916172529, 0.00034491928655499, 0.00024574880893698, 0.00036876301862154, -0.00017966371765392, -0.24657919248469, -3.3316454837094, -3.0325381939042, -0.608869845334, 2.5948165731216, 1.2262418973147, -1.8742528057091, -1.6554938222485, 3.3358741465498, 0.97575685104343, -3.0983629054888, 1.7155278030457, -1.6802588705088, -0.045810551112165, -0.10100628138954, -4.1903132563219, -3.4308850356719, -0.10796607096893, 5.2796610228892, -1.7429435833315, 0.76207328525673, 0.13455405007287, 0.95056552183227, -2.2657961328521, -5.6273952050552, 2.5917726995232}
			};
			double[] radius = DoubleArray.create(realDIM, 0.2);
			
			//HyperCube realSpace = new HyperCube(min, max);
			HyperCube realSpace = new HyperCubeFromPoint(min, max, referencePoints, radius);
			
			//Snake morphology
			String morpho = "[(0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,1.0 , 3.0, 1.0, 3.0, 1.0, 3.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]";
			//T with shoulder module morphology
			//String morpho = "[(0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,3.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,1.0 , 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]";
			double[] morphology = ChromoConversion.str2double(morpho);
			
			OptimizationFunction<double[]> function = new EmP(simulators,Nsim,morphology,maze,settings);
			//ShortChallengeEmP function = new ShortChallengeEmP(simulators,Nsim,morphology,maze,settings);
			//GenerationalEnvEmP function = new GenerationalEnvEmP(simulators,Nsim,morphology,maze,settings,10);
			MultithreadOptimizationGoal<double[]> goal = new PeriodicOptimizationGoal<double[]>(function);
			goal.setMax_threads(Nsim);
			
			IntensityMutation realVariation = new PowerLawMutation(0.2, new PermutationPick(23));
			LinearXOver realXOver = new LinearXOver(); // Use Tournament(4)
			SimpleXOver simpleXOver = new SimpleXOver();
			
			int POPSIZE = 30;
			int MAXITERS = 100;
			Variation[] opers = new Variation[3];
			opers[0] = realVariation;
			opers[1] = realXOver;
			opers[2] = simpleXOver;
			
			SimpleHaeaOperators operators = new SimpleHaeaOperators(opers);
			Selection selection = new ModifiedTournament(4);
			
			//ModifiedHaeaStep step = new ModifiedHaeaStep(POPSIZE, selection, operators);
			ModifiedHaeaStep step = new PeriodicHAEAStep(POPSIZE, selection, operators);
			step.setJsonManager(new JSONHaeaStepObjectManager());
			PopulationSearch search = new IterativePopulationSearch(step,
					new ForLoopCondition<Population>(MAXITERS));
			
			// Track Individuals and Goal Evaluations
			WriteDescriptors write_desc = new WriteDescriptors();
			Descriptors.set(Population.class, new PopulationDescriptors());
			Descriptors.set(HaeaStep.class, new HaeaStepDescriptors());
			Descriptors.set(HaeaOperators.class, new SimpleHaeaOperatorsDescriptor());
			Write.set(double[].class, new DoubleArrayPlainWrite(false));
			Write.set(HaeaStep.class, new WriteHaeaStep());
			// Descriptors.set(Population.class, new
			// PopulationDescriptors());
			Write.set(Population.class, write_desc);
			Write.set(HaeaStep.class, write_desc);
			Write.set(HaeaOperators.class, write_desc);
			
			
			// Add tracer based on descriptors set
			// FileTracer tracer = new FileTracer("Evolresult.txt", ',');
			ConsoleTracer tracer1 = new ConsoleTracer();
			Tracer.addTracer(search, tracer1);
			
			EvolutionryAlgorithmSetting easetting = new EvolutionryAlgorithmSetting(
					"HAEASlrbR"+repli, POPSIZE, MAXITERS);
			
			Solution<double[]> solution = search.solve(realSpace, goal);
			
			System.out.println(solution.object());
			
			tracer1.close();
			
			JSONObject result = new JSONObject();
			result.put("settings", easetting.encode());
			result.put("evolution", step.getJsonManager().encode());
			JSONObject jsonsolution = new JSONObject();
			jsonsolution.put("best_individual", solution.object());
			jsonsolution.put("best_fitness", solution.info(Goal.GOAL_TEST));
			result.put("solution", jsonsolution);
			String path = "./";
			try (Writer writer = new BufferedWriter(
					new OutputStreamWriter(new FileOutputStream(path + easetting.title + ".json"), "utf-8"))) {
				writer.write(result.toString());
			} catch (Exception e) {
	
			}
			
			for (Simulation sim : simulators) {
				sim.Disconnect();
			}
			
			// Stop Simulators
			for (int j = 0; j < Nsim; j++) {
				// kill all the v-rep processes
				try {
					ProcessBuilder qq = new ProcessBuilder("killall", "vrep" + j);
					File log = new File("Simout/log");
					qq.redirectErrorStream(true);
					qq.redirectOutput(Redirect.appendTo(log));
					Process p = qq.start();
					int exitVal = p.waitFor();
					System.out.println("Terminated vrep" + j + " with error code " + exitVal);
				} catch (Exception e) {
					System.out.println(e.toString());
					e.printStackTrace();
				}
			}

		}
		
	}




}
